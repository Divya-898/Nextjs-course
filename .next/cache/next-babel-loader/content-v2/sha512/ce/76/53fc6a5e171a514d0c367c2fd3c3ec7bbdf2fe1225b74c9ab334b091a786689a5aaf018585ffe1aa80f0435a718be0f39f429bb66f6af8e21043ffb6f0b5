{"ast":null,"code":"import { hashPassword } from '../../../lib/auth';\nimport { connectToDatabase } from '../../../lib/db';\n\nasync function handler(req, res) {\n  if (req.method !== 'POST') {\n    return;\n  }\n\n  const data = req.body;\n  const {\n    email,\n    password\n  } = data;\n\n  if (!email || !email.includes('@') || !password || password.trim().length < 7) {\n    res.status(422).json({\n      message: 'Invalid input - password should also be at least 7 characters long.'\n    });\n    return;\n  }\n\n  const client = await connectToDatabase();\n  const db = client.db(); // const existingUser = await db.collection('users').findOne({ email: email });\n  // if (existingUser) {\n  //   res.status(422).json({ message: 'User exists already!' });\n  //   client.close();\n  //   return;\n  // }\n\n  const hashedPassword = await hashPassword(password);\n  const result = await db.collection('users').insertOne({\n    email: email,\n    password: hashedPassword\n  });\n  result.status(201).json({\n    message: 'Created user!'\n  });\n  client.close();\n}\n\nexport default handler;","map":{"version":3,"sources":["/Users/mac/Documents/NextJs-Course/untitled folder/nextjs-course-code/pages/api/auth/signup.js"],"names":["hashPassword","connectToDatabase","handler","req","res","method","data","body","email","password","includes","trim","length","status","json","message","client","db","hashedPassword","result","collection","insertOne","close"],"mappings":"AAAA,SAASA,YAAT,QAA6B,mBAA7B;AACA,SAASC,iBAAT,QAAkC,iBAAlC;;AAEA,eAAeC,OAAf,CAAuBC,GAAvB,EAA4BC,GAA5B,EAAiC;AAC/B,MAAID,GAAG,CAACE,MAAJ,KAAe,MAAnB,EAA2B;AACzB;AACD;;AAED,QAAMC,IAAI,GAAGH,GAAG,CAACI,IAAjB;AAEA,QAAM;AAAEC,IAAAA,KAAF;AAASC,IAAAA;AAAT,MAAsBH,IAA5B;;AAEA,MACE,CAACE,KAAD,IACA,CAACA,KAAK,CAACE,QAAN,CAAe,GAAf,CADD,IAEA,CAACD,QAFD,IAGAA,QAAQ,CAACE,IAAT,GAAgBC,MAAhB,GAAyB,CAJ3B,EAKE;AACAR,IAAAA,GAAG,CAACS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,MAAAA,OAAO,EACL;AAFiB,KAArB;AAIA;AACD;;AAED,QAAMC,MAAM,GAAG,MAAMf,iBAAiB,EAAtC;AAEA,QAAMgB,EAAE,GAAGD,MAAM,CAACC,EAAP,EAAX,CAxB+B,CA0B/B;AAEA;AACA;AACA;AACA;AACA;;AAEA,QAAMC,cAAc,GAAG,MAAMlB,YAAY,CAACS,QAAD,CAAzC;AAEA,QAAMU,MAAM,GAAG,MAAMF,EAAE,CAACG,UAAH,CAAc,OAAd,EAAuBC,SAAvB,CAAiC;AACpDb,IAAAA,KAAK,EAAEA,KAD6C;AAEpDC,IAAAA,QAAQ,EAAES;AAF0C,GAAjC,CAArB;AAKAC,EAAAA,MAAM,CAACN,MAAP,CAAc,GAAd,EAAmBC,IAAnB,CAAwB;AAAEC,IAAAA,OAAO,EAAE;AAAX,GAAxB;AACAC,EAAAA,MAAM,CAACM,KAAP;AACD;;AAED,eAAepB,OAAf","sourcesContent":["import { hashPassword } from '../../../lib/auth';\nimport { connectToDatabase } from '../../../lib/db';\n\nasync function handler(req, res) {\n  if (req.method !== 'POST') {\n    return;\n  }\n\n  const data = req.body;\n\n  const { email, password } = data;\n\n  if (\n    !email ||\n    !email.includes('@') ||\n    !password ||\n    password.trim().length < 7\n  ) {\n    res.status(422).json({\n      message:\n        'Invalid input - password should also be at least 7 characters long.',\n    });\n    return;\n  }\n\n  const client = await connectToDatabase();\n\n  const db = client.db();\n\n  // const existingUser = await db.collection('users').findOne({ email: email });\n\n  // if (existingUser) {\n  //   res.status(422).json({ message: 'User exists already!' });\n  //   client.close();\n  //   return;\n  // }\n\n  const hashedPassword = await hashPassword(password);\n\n  const result = await db.collection('users').insertOne({\n    email: email,\n    password: hashedPassword,\n  });\n\n  result.status(201).json({ message: 'Created user!' });\n  client.close();\n}\n\nexport default handler;\n"]},"metadata":{},"sourceType":"module"}